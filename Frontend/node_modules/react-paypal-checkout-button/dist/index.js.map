{"version":3,"file":"index.js","sources":["../src/hooks/use-paypal-script.hook.ts","../src/hooks/use-paypal-checkout.hook.ts","../src/components/spinner.component.tsx","../src/components/error-container.component.tsx","../src/components/paypal-checkout/paypal-checkout.component.tsx"],"sourcesContent":["import { useEffect, useState } from 'react'\n// eslint-disable-next-line no-unused-vars\nimport { ButtonState, UsePayPalScriptOptions } from '../types'\n\nconst usePayPalScript = ({\n  clientId,\n  currency,\n  onError,\n  intent,\n  paypalElement\n}: UsePayPalScriptOptions) => {\n  const INTENT = intent ? `&intent=${intent?.toLocaleLowerCase()}` : ''\n\n  const [buttonState, setButtonState] = useState<ButtonState>({\n    isLoadingButton: false,\n    buttonLoaded: false,\n    errorMessage: ''\n  })\n\n  const { isLoadingButton, buttonLoaded, errorMessage } = buttonState\n\n  useEffect(() => {\n    if (errorMessage || !paypalElement) return\n\n    if (!clientId) {\n      console.log({ buttonState })\n\n      const errorMessage = 'Client Id is required to load PayPal Smart Button'\n\n      onError && onError(new Error(errorMessage))\n\n      console.error(errorMessage)\n\n      return setButtonState({\n        isLoadingButton: false,\n        buttonLoaded: false,\n        errorMessage\n      })\n    }\n\n    if (!isLoadingButton && !buttonLoaded && !errorMessage) {\n      setButtonState((prev) => ({ ...prev, isLoadingButton: true }))\n\n      const script = document.createElement('script')\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}&currency=${currency}${INTENT}`\n\n      script.addEventListener('load', () =>\n        setButtonState((prev) => ({\n          ...prev,\n          isLoadingButton: false,\n          buttonLoaded: true\n        }))\n      )\n\n      document.body.appendChild(script)\n\n      script.addEventListener('error', (error) => {\n        console.error(error)\n\n        onError && onError(error)\n\n        return setButtonState({\n          isLoadingButton: false,\n          buttonLoaded: false,\n          errorMessage: `An error occured while isLoadingButton paypal smart buttons`\n        })\n      })\n    }\n  }, [buttonState, paypalElement])\n\n  return {\n    buttonState,\n    setButtonState\n  }\n}\n\nexport default usePayPalScript\n","/* eslint-disable no-unused-vars */\n/* eslint-disable camelcase */\nimport { useEffect, useState } from 'react'\nimport {\n  OnApproveDataTypes,\n  UsePayPalCheckoutOptions,\n  UsePayPalCheckoutValues\n} from '../types'\nimport usePayPalScript from './use-paypal-script.hook'\n\nconst usePayPalCheckout = (\n  options: UsePayPalCheckoutOptions\n): UsePayPalCheckoutValues => {\n  const GlobalWindow: any = window\n\n  const [paypalElement, setPayPalElement] = useState()\n\n  const {\n    clientId,\n    intent = 'CAPTURE',\n    amount,\n    description = 'payment',\n    currency = 'USD',\n    buttonStyles,\n    onSuccess,\n    onError\n  } = options\n\n  const { buttonState, setButtonState } = usePayPalScript({\n    clientId,\n    currency,\n    onError,\n    intent,\n    paypalElement\n  })\n\n  const { isLoadingButton, buttonLoaded, errorMessage } = buttonState\n\n  const paypalRef = (node: any) => setPayPalElement(node)\n\n  const onRetry = () => {\n    setButtonState({\n      buttonLoaded: false,\n      isLoadingButton: false,\n      errorMessage: ''\n    })\n  }\n\n  const createOrder = (_data: any, actions: any) => {\n    const purchase_units = [\n      {\n        description: description,\n        amount: {\n          currency,\n          value: amount\n        }\n      }\n    ]\n\n    // console.log({ data, actions })\n\n    return actions.order.create({\n      intent,\n      purchase_units\n    })\n  }\n\n  const errorHandler = (error: any) => {\n    console.error({ error })\n\n    onError && onError(error)\n  }\n\n  const onApprove = async (data: OnApproveDataTypes, actions: any) => {\n    const getOrder = () => {\n      if (intent === 'AUTHORIZE') return actions.order.authorize()\n\n      return actions.order.capture()\n    }\n\n    const order = await getOrder()\n\n    onSuccess && onSuccess(data, order)\n  }\n\n  useEffect(() => {\n    if (buttonLoaded && !isLoadingButton && !errorMessage && paypalElement) {\n      if (!GlobalWindow?.paypal) {\n        const errorMessage =\n          'PayPal button was not buttonLoaded successfully...'\n\n        onError && onError(new Error(errorMessage))\n\n        return setButtonState({\n          isLoadingButton: false,\n          buttonLoaded: false,\n          errorMessage\n        })\n      }\n\n      setTimeout(() => {\n        GlobalWindow.paypal\n          .Buttons({\n            ...(buttonStyles && { style: buttonStyles }),\n            createOrder,\n            onApprove,\n            onError: errorHandler\n          })\n          .render(paypalElement)\n      })\n    }\n  }, [buttonState])\n\n  return {\n    ...buttonState,\n    onRetry,\n    paypalRef\n  }\n}\n\nexport default usePayPalCheckout\n","/* eslint-disable no-unused-vars */\nimport React from 'react'\nimport { SpinnerProps } from '../types'\nimport styles from '../styles.module.css'\n\nconst Spinner: React.FC<SpinnerProps> = ({ isLoading }) =>\n  isLoading ? <div className={styles.spinner} /> : null\n\nexport default Spinner\n","/* eslint-disable no-unused-vars */\nimport React from 'react'\nimport { ErrorContainerProps } from '../types'\nimport styles from '../styles.module.css'\n\nconst ErrorContainer: React.FC<ErrorContainerProps> = ({\n  errorMessage,\n  onRetry\n}) => (\n  <div className={styles['error-container']}>\n    <p className={styles['error-message']}>{errorMessage}</p>\n\n    <button onClick={onRetry && onRetry} className={styles['retry-button']}>\n      Try again\n    </button>\n  </div>\n)\n\nexport default ErrorContainer\n","/* eslint-disable camelcase */\n/* eslint-disable no-unused-vars */\nimport React from 'react'\nimport { PayPalCheckoutProps } from '../../types'\n\nimport styles from '../../styles.module.css'\nimport usePayPalCheckout from '../../hooks/use-paypal-checkout.hook'\nimport Spinner from '../spinner.component'\nimport ErrorContainer from '../error-container.component'\n\nconst PayPalCheckout: React.FC<PayPalCheckoutProps> = (props) => {\n  const {\n    isLoadingButton,\n    buttonLoaded,\n    errorMessage,\n    onRetry,\n\n    paypalRef\n  } = usePayPalCheckout({\n    ...props\n  })\n\n  const renderReactPayPalStates = () => {\n    if (buttonLoaded) return\n\n    if (isLoadingButton) return <Spinner isLoading={isLoadingButton} />\n\n    if (errorMessage)\n      return <ErrorContainer errorMessage={errorMessage} onRetry={onRetry} />\n\n    return null\n  }\n\n  return (\n    <div className={styles.container}>\n      <div ref={paypalRef} />\n\n      {renderReactPayPalStates()}\n    </div>\n  )\n}\n\nexport default React.memo(PayPalCheckout)\n"],"names":["usePayPalScript","clientId","currency","onError","intent","paypalElement","INTENT","toLocaleLowerCase","useState","isLoadingButton","buttonLoaded","errorMessage","buttonState","setButtonState","useEffect","console","log","Error","error","prev","script","document","createElement","src","addEventListener","body","appendChild","usePayPalCheckout","options","GlobalWindow","window","setPayPalElement","amount","description","buttonStyles","onSuccess","paypalRef","node","onRetry","createOrder","_data","actions","purchase_units","value","order","create","errorHandler","onApprove","data","getOrder","authorize","capture","paypal","setTimeout","Buttons","style","render","Spinner","isLoading","React","className","styles","spinner","ErrorContainer","onClick","PayPalCheckout","props","renderReactPayPalStates","container","ref","memo"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAIA,IAAMA,eAAe,GAAG,SAAlBA,eAAkB;MACtBC,gBAAAA;MACAC,gBAAAA;MACAC,eAAAA;MACAC,cAAAA;MACAC,qBAAAA;AAEA,MAAMC,MAAM,GAAGF,MAAM,iBAAcA,MAAd,aAAcA,MAAd,uBAAcA,MAAM,CAAEG,iBAAR,EAAd,IAA8C,EAAnE;;kBAEsCC,cAAQ,CAAc;AAC1DC,IAAAA,eAAe,EAAE,KADyC;AAE1DC,IAAAA,YAAY,EAAE,KAF4C;AAG1DC,IAAAA,YAAY,EAAE;AAH4C,GAAd;MAAvCC;MAAaC;;MAMZJ,kBAAgDG,YAAhDH;MAAiBC,eAA+BE,YAA/BF;MAAcC,eAAiBC,YAAjBD;AAEvCG,EAAAA,eAAS,CAAC;AACR,QAAIH,YAAY,IAAI,CAACN,aAArB,EAAoC;;AAEpC,QAAI,CAACJ,QAAL,EAAe;AACbc,MAAAA,OAAO,CAACC,GAAR,CAAY;AAAEJ,QAAAA,WAAW,EAAXA;AAAF,OAAZ;AAEA,UAAMD,aAAY,GAAG,mDAArB;AAEAR,MAAAA,OAAO,IAAIA,OAAO,CAAC,IAAIc,KAAJ,CAAUN,aAAV,CAAD,CAAlB;AAEAI,MAAAA,OAAO,CAACG,KAAR,CAAcP,aAAd;AAEA,aAAOE,cAAc,CAAC;AACpBJ,QAAAA,eAAe,EAAE,KADG;AAEpBC,QAAAA,YAAY,EAAE,KAFM;AAGpBC,QAAAA,YAAY,EAAZA;AAHoB,OAAD,CAArB;AAKD;;AAED,QAAI,CAACF,eAAD,IAAoB,CAACC,YAArB,IAAqC,CAACC,YAA1C,EAAwD;AACtDE,MAAAA,cAAc,CAAC,UAACM,IAAD;AAAA,4BAAgBA,IAAhB;AAAsBV,UAAAA,eAAe,EAAE;AAAvC;AAAA,OAAD,CAAd;AAEA,UAAMW,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,MAAAA,MAAM,CAACG,GAAP,gDAAwDtB,QAAxD,kBAA6EC,QAA7E,GAAwFI,MAAxF;AAEAc,MAAAA,MAAM,CAACI,gBAAP,CAAwB,MAAxB,EAAgC;AAAA,eAC9BX,cAAc,CAAC,UAACM,IAAD;AAAA,8BACVA,IADU;AAEbV,YAAAA,eAAe,EAAE,KAFJ;AAGbC,YAAAA,YAAY,EAAE;AAHD;AAAA,SAAD,CADgB;AAAA,OAAhC;AAQAW,MAAAA,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA0BN,MAA1B;AAEAA,MAAAA,MAAM,CAACI,gBAAP,CAAwB,OAAxB,EAAiC,UAACN,KAAD;AAC/BH,QAAAA,OAAO,CAACG,KAAR,CAAcA,KAAd;AAEAf,QAAAA,OAAO,IAAIA,OAAO,CAACe,KAAD,CAAlB;AAEA,eAAOL,cAAc,CAAC;AACpBJ,UAAAA,eAAe,EAAE,KADG;AAEpBC,UAAAA,YAAY,EAAE,KAFM;AAGpBC,UAAAA,YAAY;AAHQ,SAAD,CAArB;AAKD,OAVD;AAWD;AACF,GA/CQ,EA+CN,CAACC,WAAD,EAAcP,aAAd,CA/CM,CAAT;AAiDA,SAAO;AACLO,IAAAA,WAAW,EAAXA,WADK;AAELC,IAAAA,cAAc,EAAdA;AAFK,GAAP;AAID,CAtED;;ACMA,IAAMc,iBAAiB,GAAG,SAApBA,iBAAoB,CACxBC,OADwB;AAGxB,MAAMC,YAAY,GAAQC,MAA1B;;kBAE0CtB,cAAQ;MAA3CH;MAAe0B;;MAGpB9B,WAQE2B,QARF3B;wBAQE2B,QAPFxB;MAAAA,sCAAS;MACT4B,SAMEJ,QANFI;6BAMEJ,QALFK;MAAAA,gDAAc;0BAKZL,QAJF1B;MAAAA,0CAAW;MACXgC,eAGEN,QAHFM;MACAC,YAEEP,QAFFO;MACAhC,UACEyB,QADFzB;;yBAGsCH,eAAe,CAAC;AACtDC,IAAAA,QAAQ,EAARA,QADsD;AAEtDC,IAAAA,QAAQ,EAARA,QAFsD;AAGtDC,IAAAA,OAAO,EAAPA,OAHsD;AAItDC,IAAAA,MAAM,EAANA,MAJsD;AAKtDC,IAAAA,aAAa,EAAbA;AALsD,GAAD;MAA/CO,+BAAAA;MAAaC,kCAAAA;;MAQbJ,kBAAgDG,YAAhDH;MAAiBC,eAA+BE,YAA/BF;MAAcC,eAAiBC,YAAjBD;;AAEvC,MAAMyB,SAAS,GAAG,SAAZA,SAAY,CAACC,IAAD;AAAA,WAAeN,gBAAgB,CAACM,IAAD,CAA/B;AAAA,GAAlB;;AAEA,MAAMC,OAAO,GAAG,SAAVA,OAAU;AACdzB,IAAAA,cAAc,CAAC;AACbH,MAAAA,YAAY,EAAE,KADD;AAEbD,MAAAA,eAAe,EAAE,KAFJ;AAGbE,MAAAA,YAAY,EAAE;AAHD,KAAD,CAAd;AAKD,GAND;;AAQA,MAAM4B,WAAW,GAAG,SAAdA,WAAc,CAACC,KAAD,EAAaC,OAAb;AAClB,QAAMC,cAAc,GAAG,CACrB;AACET,MAAAA,WAAW,EAAEA,WADf;AAEED,MAAAA,MAAM,EAAE;AACN9B,QAAAA,QAAQ,EAARA,QADM;AAENyC,QAAAA,KAAK,EAAEX;AAFD;AAFV,KADqB,CAAvB;AAYA,WAAOS,OAAO,CAACG,KAAR,CAAcC,MAAd,CAAqB;AAC1BzC,MAAAA,MAAM,EAANA,MAD0B;AAE1BsC,MAAAA,cAAc,EAAdA;AAF0B,KAArB,CAAP;AAID,GAjBD;;AAmBA,MAAMI,YAAY,GAAG,SAAfA,YAAe,CAAC5B,KAAD;AACnBH,IAAAA,OAAO,CAACG,KAAR,CAAc;AAAEA,MAAAA,KAAK,EAALA;AAAF,KAAd;AAEAf,IAAAA,OAAO,IAAIA,OAAO,CAACe,KAAD,CAAlB;AACD,GAJD;;AAMA,MAAM6B,SAAS,YAATA,SAAS,CAAUC,IAAV,EAAoCP,OAApC;AAAA;AACb,UAAMQ,QAAQ,GAAG,SAAXA,QAAW;AACf,YAAI7C,MAAM,KAAK,WAAf,EAA4B,OAAOqC,OAAO,CAACG,KAAR,CAAcM,SAAd,EAAP;AAE5B,eAAOT,OAAO,CAACG,KAAR,CAAcO,OAAd,EAAP;AACD,OAJD;;6BAMoBF,QAAQ,mBAAtBL;AAENT,QAAAA,SAAS,IAAIA,SAAS,CAACa,IAAD,EAAOJ,KAAP,CAAtB;;AACD,KAVc;AAAA;AAAA;AAAA,GAAf;;AAYA9B,EAAAA,eAAS,CAAC;AACR,QAAIJ,YAAY,IAAI,CAACD,eAAjB,IAAoC,CAACE,YAArC,IAAqDN,aAAzD,EAAwE;AACtE,UAAI,EAACwB,YAAD,aAACA,YAAD,eAACA,YAAY,CAAEuB,MAAf,CAAJ,EAA2B;AACzB,YAAMzC,aAAY,GAChB,oDADF;AAGAR,QAAAA,OAAO,IAAIA,OAAO,CAAC,IAAIc,KAAJ,CAAUN,aAAV,CAAD,CAAlB;AAEA,eAAOE,cAAc,CAAC;AACpBJ,UAAAA,eAAe,EAAE,KADG;AAEpBC,UAAAA,YAAY,EAAE,KAFM;AAGpBC,UAAAA,YAAY,EAAZA;AAHoB,SAAD,CAArB;AAKD;;AAED0C,MAAAA,UAAU,CAAC;AACTxB,QAAAA,YAAY,CAACuB,MAAb,CACGE,OADH,cAEQpB,YAAY,IAAI;AAAEqB,UAAAA,KAAK,EAAErB;AAAT,SAFxB;AAGIK,UAAAA,WAAW,EAAXA,WAHJ;AAIIQ,UAAAA,SAAS,EAATA,SAJJ;AAKI5C,UAAAA,OAAO,EAAE2C;AALb,YAOGU,MAPH,CAOUnD,aAPV;AAQD,OATS,CAAV;AAUD;AACF,GA1BQ,EA0BN,CAACO,WAAD,CA1BM,CAAT;AA4BA,sBACKA,WADL;AAEE0B,IAAAA,OAAO,EAAPA,OAFF;AAGEF,IAAAA,SAAS,EAATA;AAHF;AAKD,CA5GD;;ACLA,IAAMqB,OAAO,GAA2B,SAAlCA,OAAkC;AAAA,MAAGC,SAAH,QAAGA,SAAH;AAAA,SACtCA,SAAS,GAAGC,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAEC,MAAM,CAACC;GAAvB,CAAH,GAAwC,IADX;AAAA,CAAxC;;ACAA,IAAMC,cAAc,GAAkC,SAAhDA,cAAgD;AAAA,MACpDpD,YADoD,QACpDA,YADoD;AAAA,MAEpD2B,OAFoD,QAEpDA,OAFoD;AAAA,SAIpDqB,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAEC,MAAM,CAAC,iBAAD;GAAtB,EACEF,4BAAA,IAAA;AAAGC,IAAAA,SAAS,EAAEC,MAAM,CAAC,eAAD;GAApB,EAAwClD,YAAxC,CADF,EAGEgD,4BAAA,SAAA;AAAQK,IAAAA,OAAO,EAAE1B,OAAO,IAAIA;AAASsB,IAAAA,SAAS,EAAEC,MAAM,CAAC,cAAD;GAAtD,aAAA,CAHF,CAJoD;AAAA,CAAtD;;ACKA,IAAMI,cAAc,GAAkC,SAAhDA,cAAgD,CAACC,KAAD;2BAQhDvC,iBAAiB,cAChBuC,KADgB;MANnBzD,qCAAAA;MACAC,kCAAAA;MACAC,kCAAAA;MACA2B,6BAAAA;MAEAF,+BAAAA;;AAKF,MAAM+B,uBAAuB,GAAG,SAA1BA,uBAA0B;AAC9B,QAAIzD,YAAJ,EAAkB;AAElB,QAAID,eAAJ,EAAqB,OAAOkD,4BAAA,CAACF,OAAD;AAASC,MAAAA,SAAS,EAAEjD;KAApB,CAAP;AAErB,QAAIE,YAAJ,EACE,OAAOgD,4BAAA,CAACI,cAAD;AAAgBpD,MAAAA,YAAY,EAAEA;AAAc2B,MAAAA,OAAO,EAAEA;KAArD,CAAP;AAEF,WAAO,IAAP;AACD,GATD;;AAWA,SACEqB,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAEC,MAAM,CAACO;GAAvB,EACET,4BAAA,MAAA;AAAKU,IAAAA,GAAG,EAAEjC;GAAV,CADF,EAGG+B,uBAAuB,EAH1B,CADF;AAOD,CA9BD;;AAgCA,+BAAeR,cAAK,CAACW,IAAN,CAAWL,cAAX,CAAf;;;;;"}